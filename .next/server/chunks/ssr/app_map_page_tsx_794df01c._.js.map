{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Andre/Documents/GitHub/lokalista/app/map/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport { createClient } from \"@/lib/supabase/browserClient\";\r\n\r\nexport default function MapPage() {\r\n  const mapEl = useRef<HTMLDivElement | null>(null);\r\n  const mapRef = useRef<any>(null);\r\n  const userMarkerRef = useRef<any>(null);\r\n  const searchMarkerRef = useRef<any>(null);\r\n  const initializingRef = useRef<boolean>(false);\r\n  const [query, setQuery] = useState(\"\");\r\n  const [mood, setMood] = useState(\"\");\r\n  const moodRef = useRef<string>(\"\");\r\n  const [loadingLoc, setLoadingLoc] = useState(false);\r\n  const [searching, setSearching] = useState(false);\r\n  const [suggestions, setSuggestions] = useState<Array<{ display: string; lat: number; lon: number }>>([]);\r\n  const [showSuggestions, setShowSuggestions] = useState(false);\r\n  const debounceRef = useRef<any>(null);\r\n  const [results, setResults] = useState<Array<any>>([]);\r\n  const [loadingRecs, setLoadingRecs] = useState(false);\r\n  const [selectedLatLng, setSelectedLatLng] = useState<[number, number] | null>(null);\r\n\r\n  // Inject Leaflet CSS/JS from CDN to avoid local install\r\n  useEffect(() => {\r\n    moodRef.current = mood;\r\n  }, [mood]);\r\n\r\n  // Initialize Leaflet map once. Guard against double init in React StrictMode.\r\n  useEffect(() => {\r\n    const ensureAssets = async () => {\r\n      if (!document.querySelector('link[data-leaflet-css=\"true\"]')) {\r\n        const link = document.createElement(\"link\");\r\n        link.rel = \"stylesheet\";\r\n        link.href = \"https://unpkg.com/leaflet@1.9.4/dist/leaflet.css\";\r\n        link.setAttribute(\"data-leaflet-css\", \"true\");\r\n        document.head.appendChild(link);\r\n      }\r\n      if (!(window as any).L) {\r\n        await new Promise<void>((resolve) => {\r\n          const script = document.createElement(\"script\");\r\n          script.src = \"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js\";\r\n          script.async = true;\r\n          script.onload = () => resolve();\r\n          document.body.appendChild(script);\r\n        });\r\n      }\r\n    };\r\n\r\n    const init = async () => {\r\n      if (initializingRef.current || mapRef.current) return;\r\n      initializingRef.current = true;\r\n      await ensureAssets();\r\n      const L = (window as any).L;\r\n      if (!mapEl.current) return;\r\n\r\n      // Default to Manila center if geolocation unavailable\r\n      const defaultCenter: [number, number] = [14.5995, 120.9842];\r\n      mapRef.current = L.map(mapEl.current, {\r\n        center: defaultCenter,\r\n        zoom: 13,\r\n      });\r\n\r\n      // Clean light basemap without POI labels (no dark mode)\r\n      L.tileLayer(\"https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png\", {\r\n        maxZoom: 19,\r\n        attribution: '&copy; OpenStreetMap contributors, &copy; CARTO',\r\n      }).addTo(mapRef.current);\r\n\r\n      // Ask for geolocation and center\r\n      locateUser();\r\n\r\n      // Click to set selection marker and popup placeholder\r\n      mapRef.current.on(\"click\", (e: any) => {\r\n        const latlng = e.latlng;\r\n        const currentMood = moodRef.current;\r\n        dropSearchMarker(latlng, `This is where we'll recommend places for your mood${currentMood ? ` (${currentMood})` : \"\"}.`);\r\n        setSelectedLatLng([latlng.lat, latlng.lng]);\r\n        fetchRecommendations([latlng.lat, latlng.lng]);\r\n      });\r\n      initializingRef.current = false;\r\n    };\r\n\r\n    init();\r\n\r\n    return () => {\r\n      if (mapRef.current) {\r\n        mapRef.current.remove();\r\n        mapRef.current = null;\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  async function locateUser() {\r\n    if (!mapRef.current) return;\r\n    if (!(\"geolocation\" in navigator)) return;\r\n    try {\r\n      setLoadingLoc(true);\r\n      const pos = await new Promise<GeolocationPosition>((resolve, reject) => {\r\n        navigator.geolocation.getCurrentPosition(resolve, reject, {\r\n          enableHighAccuracy: true,\r\n          timeout: 15000,\r\n          maximumAge: 10000,\r\n        });\r\n      });\r\n      const latlng: [number, number] = [pos.coords.latitude, pos.coords.longitude];\r\n      const L = (window as any).L;\r\n      if (userMarkerRef.current) {\r\n        userMarkerRef.current.setLatLng(latlng);\r\n      } else {\r\n        const youIcon = L.divIcon({\r\n          html: '<div style=\"background:#2563eb;color:#fff;border-radius:9999px;padding:6px 10px;box-shadow:0 2px 6px rgba(0,0,0,.25)\">You</div>',\r\n          className: '', iconSize: [36, 24], iconAnchor: [18, 12]\r\n        });\r\n        userMarkerRef.current = L.marker(latlng, { icon: youIcon });\r\n        userMarkerRef.current.addTo(mapRef.current);\r\n      }\r\n      mapRef.current.setView(latlng, 15);\r\n      userMarkerRef.current.bindPopup(\"You are here\").openPopup();\r\n      // Auto-load nearby venues around current location\r\n      setSelectedLatLng(latlng);\r\n      fetchRecommendations(latlng);\r\n    } catch (_) {\r\n      // ignore; user may deny permission\r\n    } finally {\r\n      setLoadingLoc(false);\r\n    }\r\n  }\r\n\r\n  function dropSearchMarker(latlng: { lat: number; lng: number } | [number, number], popupText?: string) {\r\n    const L = (window as any).L;\r\n    const ll = Array.isArray(latlng) ? latlng : [latlng.lat, latlng.lng];\r\n    if (searchMarkerRef.current) {\r\n      searchMarkerRef.current.setLatLng(ll);\r\n    } else {\r\n      searchMarkerRef.current = L.marker(ll);\r\n      searchMarkerRef.current.addTo(mapRef.current);\r\n    }\r\n    if (popupText) searchMarkerRef.current.bindPopup(popupText).openPopup();\r\n    mapRef.current.setView(ll, 16);\r\n  }\r\n\r\n  async function geocodeSearch(e: React.FormEvent) {\r\n    e.preventDefault();\r\n    if (!query.trim()) return;\r\n    setSearching(true);\r\n    try {\r\n      // Restrict to Philippines results where possible\r\n      const url = `https://nominatim.openstreetmap.org/search?format=json&countrycodes=ph&limit=5&q=${encodeURIComponent(query)}`;\r\n      const res = await fetch(url, { headers: { \"Accept-Language\": \"en\" } });\r\n      const data = await res.json();\r\n      if (data && data.length > 0) {\r\n        const best = data[0];\r\n        const lat = parseFloat(best.lat);\r\n        const lon = parseFloat(best.lon);\r\n        dropSearchMarker({ lat, lng: lon }, `This is where we'll recommend places for your mood${mood ? ` (${mood})` : \"\"}.`);\r\n        setSelectedLatLng([lat, lon]);\r\n        fetchRecommendations([lat, lon]);\r\n        setSuggestions(\r\n          data.map((d: any) => ({ display: d.display_name, lat: parseFloat(d.lat), lon: parseFloat(d.lon) }))\r\n        );\r\n        setShowSuggestions(true);\r\n      } else {\r\n        setSuggestions([]);\r\n        setShowSuggestions(false);\r\n        alert(\"No results found.\");\r\n      }\r\n    } finally {\r\n      setSearching(false);\r\n    }\r\n  }\r\n\r\n  // Live suggestions with debounce on input change\r\n  function onQueryChange(v: string) {\r\n    setQuery(v);\r\n    if (debounceRef.current) clearTimeout(debounceRef.current);\r\n    if (!v.trim()) {\r\n      setSuggestions([]);\r\n      setShowSuggestions(false);\r\n      return;\r\n    }\r\n    debounceRef.current = setTimeout(async () => {\r\n      try {\r\n        const url = `https://nominatim.openstreetmap.org/search?format=json&countrycodes=ph&limit=5&q=${encodeURIComponent(v)}`;\r\n        const res = await fetch(url, { headers: { \"Accept-Language\": \"en\" } });\r\n        const data = await res.json();\r\n        setSuggestions((data || []).map((d: any) => ({ display: d.display_name, lat: parseFloat(d.lat), lon: parseFloat(d.lon) })));\r\n        setShowSuggestions(true);\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }, 400);\r\n  }\r\n\r\n  async function fetchRecommendations(centerLatLng: [number, number]) {\r\n    setLoadingRecs(true);\r\n    try {\r\n      const [lat, lon] = centerLatLng;\r\n      // Define a rough bounding box around the point (~15km) for better coverage\r\n      const delta = 0.15;\r\n      const minLat = lat - delta;\r\n      const maxLat = lat + delta;\r\n      const minLon = lon - delta;\r\n      const maxLon = lon + delta;\r\n\r\n      const supabase = createClient();\r\n\r\n      // Optional mood filter - matches category or name for demo\r\n      let queryBuilder = supabase\r\n        .from(\"places\")\r\n        .select(\"id,name,description,latitude,longitude,category,price_range,rating,image_url\")\r\n        .gte(\"latitude\", minLat)\r\n        .lte(\"latitude\", maxLat)\r\n        .gte(\"longitude\", minLon)\r\n        .lte(\"longitude\", maxLon)\r\n        .limit(50);\r\n\r\n      if (mood) {\r\n        // naive filter: category ilike mood OR name/description contains mood\r\n        queryBuilder = queryBuilder.or(\r\n          `category.ilike.%${mood}%,name.ilike.%${mood}%,description.ilike.%${mood}%`\r\n        );\r\n      }\r\n\r\n      const { data, error } = await queryBuilder;\r\n      if (error) throw error;\r\n      // filter to relevant venue types, but if filtering yields nothing, fall back to raw results\r\n      const allowed = [\"restaurant\",\"restaurants\",\"cafe\",\"coffee\",\"event\",\"events\",\"bar\",\"food\",\"eatery\"]; \r\n      let filtered = (data || []).filter((p: any) => {\r\n        const cat = (p.category || \"\").toLowerCase();\r\n        const name = (p.name || \"\").toLowerCase();\r\n        const desc = (p.description || \"\").toLowerCase();\r\n        const categoryMatch = allowed.some((a) => cat.includes(a));\r\n        const moodMatch = !mood || cat.includes(mood.toLowerCase()) || name.includes(mood.toLowerCase()) || desc.includes(mood.toLowerCase());\r\n        return categoryMatch && moodMatch;\r\n      });\r\n      if (filtered.length === 0) filtered = data || [];\r\n      setResults(filtered);\r\n\r\n      // Plot markers\r\n      const L = (window as any).L;\r\n      // Remove old search marker popup text and re-add\r\n      if (searchMarkerRef.current) {\r\n        searchMarkerRef.current.bindPopup(`Found ${filtered.length} places${mood ? ` for \"${mood}\"` : \"\"} near here.`);\r\n      }\r\n\r\n      // Remove previous result markers\r\n      if (!(window as any).__resultMarkers) (window as any).__resultMarkers = [];\r\n      ((window as any).__resultMarkers as any[]).forEach((m) => { try { m.remove(); } catch {} });\r\n      (window as any).__resultMarkers = [];\r\n\r\n      // Add individual markers\r\n      filtered.forEach((p: any) => {\r\n        if (typeof p.latitude !== \"number\" || typeof p.longitude !== \"number\") return;\r\n        const iconHtml = `\r\n          <div style=\"display:flex;align-items:center;gap:4px;background:#1f2937;color:#fff;border-radius:9999px;padding:4px 8px;box-shadow:0 2px 6px rgba(0,0,0,.25)\">\r\n            <span style=\"font-size:12px\">${typeof p.rating === \"number\" ? p.rating.toFixed(1) : \"\"}</span>\r\n            <span style=\"width:20px;height:20px;display:inline-grid;place-items:center;background:#ef4444;border-radius:9999px\">☕</span>\r\n          </div>`;\r\n        const customIcon = L.divIcon({ html: iconHtml, className: \"\", iconSize: [40, 24], iconAnchor: [20, 12] });\r\n        const m = L.marker([p.latitude, p.longitude], { icon: customIcon });\r\n        m.addTo(mapRef.current);\r\n        m.bindPopup(`<strong>${p.name}</strong><br/>${p.category || \"\"}${p.price_range ? ` • ${p.price_range}` : \"\"}`);\r\n        (window as any).__resultMarkers.push(m);\r\n      });\r\n    } catch (_) {\r\n      setResults([]);\r\n    } finally {\r\n      setLoadingRecs(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen\" style={{ backgroundColor: \"#ffffff\" }}>\r\n      <div className=\"container py-4\">\r\n        <div className=\"mb-3 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between\">\r\n          <form onSubmit={geocodeSearch} className=\"relative flex-1 flex gap-2\">\r\n            <input\r\n              value={query}\r\n              onChange={(e) => onQueryChange(e.target.value)}\r\n              onFocus={() => suggestions.length && setShowSuggestions(true)}\r\n              placeholder=\"Search a place (restaurant, café, event space)\"\r\n              className=\"h-10 w-full px-3 rounded-md border border-gray-300\"\r\n            />\r\n            <button type=\"submit\" className=\"h-10 px-4 rounded-md bg-[#8c52ff] text-white\">{searching ? \"Searching…\" : \"Search\"}</button>\r\n            {showSuggestions && suggestions.length > 0 && (\r\n              <div className=\"absolute top-11 left-0 right-0 z-10 bg-white border border-gray-200 rounded-md shadow\">\r\n                {suggestions.map((s, i) => (\r\n                  <button\r\n                    type=\"button\"\r\n                    key={`${s.lat}-${s.lon}-${i}`}\r\n                    onClick={() => {\r\n                      dropSearchMarker({ lat: s.lat, lng: s.lon }, `This is where we'll recommend places for your mood${mood ? ` (${mood})` : \"\"}.`);\r\n                      setSelectedLatLng([s.lat, s.lon]);\r\n                      fetchRecommendations([s.lat, s.lon]);\r\n                      setShowSuggestions(false);\r\n                    }}\r\n                    className=\"block w-full text-left px-3 py-2 hover:bg-gray-50 text-sm\"\r\n                  >\r\n                    {s.display}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </form>\r\n          <div className=\"flex gap-2\">\r\n            <select value={mood} onChange={(e) => setMood(e.target.value)} className=\"h-10 px-3 rounded-md border border-gray-300\">\r\n              <option value=\"\">Mood: Any</option>\r\n              <option value=\"chill\">Chill</option>\r\n              <option value=\"adventurous\">Adventurous</option>\r\n              <option value=\"romantic\">Romantic</option>\r\n              <option value=\"social\">Social</option>\r\n            </select>\r\n            <button onClick={locateUser} disabled={loadingLoc} className=\"h-10 px-4 rounded-md border border-gray-300\">{loadingLoc ? \"Locating…\" : \"Use my location\"}</button>\r\n          </div>\r\n        </div>\r\n        <div ref={mapEl} style={{ width: \"100%\", height: \"60vh\", borderRadius: 12, overflow: \"hidden\", border: \"1px solid #e5e7eb\" }} />\r\n\r\n        <div className=\"mt-4\">\r\n          <h2 className=\"text-lg font-semibold mb-2\">Recommendations {loadingRecs ? \"(loading…)\" : \"\"}</h2>\r\n          {results.length === 0 && !loadingRecs && (\r\n            <div className=\"text-sm text-gray-600\">Search a place or click the map to see nearby restaurants, cafes, and events.</div>\r\n          )}\r\n          <div className=\"grid md:grid-cols-2 gap-3\">\r\n            {results.map((r: any) => (\r\n              <div key={r.id} className=\"rounded-md border border-gray-200 p-3\">\r\n                <div className=\"font-medium\">{r.name}</div>\r\n                <div className=\"text-sm text-gray-600\">{r.category || \"\"}{r.price_range ? ` • ${r.price_range}` : \"\"}</div>\r\n                {typeof r.rating === \"number\" && (\r\n                  <div className=\"text-sm\">Rating: {r.rating}</div>\r\n                )}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n"],"names":[],"mappings":"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","debugId":null}}]
}