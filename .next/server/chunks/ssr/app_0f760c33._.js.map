{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Andre/Documents/GitHub/lokalista/app/ui/Modal.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect } from \"react\";\r\n\r\ntype ModalProps = {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  title?: string;\r\n  children: React.ReactNode;\r\n  className?: string;\r\n  showCloseButton?: boolean;\r\n};\r\n\r\nexport default function Modal({ open, onClose, title, children, className = \"\", showCloseButton = true }: ModalProps) {\r\n  useEffect(() => {\r\n    function onKey(e: KeyboardEvent) {\r\n      if (e.key === \"Escape\") onClose();\r\n    }\r\n    if (open) {\r\n      document.addEventListener(\"keydown\", onKey);\r\n      document.body.style.overflow = \"hidden\";\r\n    }\r\n    return () => {\r\n      document.removeEventListener(\"keydown\", onKey);\r\n      document.body.style.overflow = \"\";\r\n    };\r\n  }, [open, onClose]);\r\n\r\n  if (!open) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\r\n      <div className=\"absolute inset-0 bg-black/50\" onClick={onClose} />\r\n      <div role=\"dialog\" aria-modal=\"true\" className={`relative z-10 w-full rounded-lg border border-border/60 bg-background shadow-xl ${className || 'max-w-md p-5'}`}>\r\n        {title && <div className=\"h2 mb-2\">{title}</div>}\r\n        {children}\r\n        {showCloseButton && (\r\n          <div className=\"mt-4 flex justify-end\">\r\n            <button onClick={onClose} className=\"h-9 px-4 rounded-md border border-border/60\">Close</button>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n} "],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAae,SAAS,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE,YAAY,EAAE,EAAE,kBAAkB,IAAI,EAAc;IAClH,IAAA,kNAAS,EAAC;QACR,SAAS,MAAM,CAAgB;YAC7B,IAAI,EAAE,GAAG,KAAK,UAAU;QAC1B;QACA,IAAI,MAAM;YACR,SAAS,gBAAgB,CAAC,WAAW;YACrC,SAAS,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG;QACjC;QACA,OAAO;YACL,SAAS,mBAAmB,CAAC,WAAW;YACxC,SAAS,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG;QACjC;IACF,GAAG;QAAC;QAAM;KAAQ;IAElB,IAAI,CAAC,MAAM,OAAO;IAElB,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;gBAA+B,SAAS;;;;;;0BACvD,8OAAC;gBAAI,MAAK;gBAAS,cAAW;gBAAO,WAAW,CAAC,gFAAgF,EAAE,aAAa,gBAAgB;;oBAC7J,uBAAS,8OAAC;wBAAI,WAAU;kCAAW;;;;;;oBACnC;oBACA,iCACC,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BAAO,SAAS;4BAAS,WAAU;sCAA8C;;;;;;;;;;;;;;;;;;;;;;;AAM9F","debugId":null}},
    {"offset": {"line": 89, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Andre/Documents/GitHub/lokalista/app/community/page.tsx"],"sourcesContent":["\"use client\";\r\n/* eslint-disable @typescript-eslint/no-explicit-any, @next/next/no-img-element */\r\n\r\n// Clone of journey page but with /community redirects\r\nimport { useEffect, useMemo, useState, useRef } from \"react\";\r\nimport { createClient } from \"@/lib/supabase/browserClient\";\r\nimport Modal from \"@/app/ui/Modal\";\r\n\r\ntype Profile = {\r\n  id: string;\r\n  first_name?: string | null;\r\n  last_name?: string | null;\r\n  avatar_url?: string | null;\r\n};\r\n\r\ntype Post = {\r\n  id: string;\r\n  user_id: string;\r\n  content: string;\r\n  created_at: string;\r\n  profiles?: Profile | null;\r\n  likes_count?: number;\r\n  comments_count?: number;\r\n  liked_by_me?: boolean;\r\n  image_url?: string | null;\r\n};\r\n\r\ntype Comment = {\r\n  id: string;\r\n  post_id: string;\r\n  user_id: string;\r\n  content: string;\r\n  created_at: string;\r\n  profiles?: Profile | null;\r\n};\r\n\r\nconst extractProfile = (profile: any): Profile | null => {\r\n  if (!profile) return null;\r\n  // Handle array case (from Supabase joins)\r\n  if (Array.isArray(profile)) {\r\n    return profile[0] ?? null;\r\n  }\r\n  // Handle object case\r\n  if (typeof profile === 'object') {\r\n    return profile as Profile;\r\n  }\r\n  return null;\r\n};\r\n\r\n// Helper function to get display name from profile - ONLY uses profiles table data\r\nconst getDisplayName = (profile: Profile | null | undefined, userId: string): string => {\r\n  // Use first_name and last_name from profiles table\r\n  if (profile?.first_name || profile?.last_name) {\r\n    const firstName = profile.first_name || \"\";\r\n    const lastName = profile.last_name || \"\";\r\n    const fullName = `${firstName}${lastName ? ` ${lastName}` : \"\"}`.trim();\r\n    if (fullName) return fullName;\r\n  }\r\n  \r\n  // Fallback: use first 8 characters of user_id if no name in profile\r\n  return userId ? `User ${userId.slice(0, 8)}` : \"User\";\r\n};\r\n\r\nexport default function CommunityPage() {\r\n  const supabase = useMemo(() => createClient(), []);\r\n  const [userId, setUserId] = useState<string | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [content, setContent] = useState(\"\");\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [posts, setPosts] = useState<Post[]>([]);\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  const [expandedPostIds, setExpandedPostIds] = useState<Set<string>>(new Set());\r\n  const [commentsByPost, setCommentsByPost] = useState<Record<string, Comment[]>>({});\r\n  const [newCommentContent, setNewCommentContent] = useState<Record<string, string>>({});\r\n  const [imageFiles, setImageFiles] = useState<File[]>([]);\r\n  const [imagePreviews, setImagePreviews] = useState<string[]>([]);\r\n  const [currentImageIndex, setCurrentImageIndex] = useState(0);\r\n  const [selectedPost, setSelectedPost] = useState<Post | null>(null);\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [isComposerOpen, setIsComposerOpen] = useState(false);\r\n  const [deletingPost, setDeletingPost] = useState<string | null>(null);\r\n  const [deletingComment, setDeletingComment] = useState<string | null>(null);\r\n  const [currentPostImageIndex, setCurrentPostImageIndex] = useState<Record<string, number>>({});\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    (async () => {\r\n      const { data } = await supabase.auth.getUser();\r\n      if (!mounted) return;\r\n      const uid = data.user?.id ?? null;\r\n      setUserId(uid);\r\n      \r\n      // Ensure current user's profile has first_name/last_name populated from metadata if missing\r\n      if (uid && data.user) {\r\n        try {\r\n      const { data: profileData } = await supabase\r\n            .from(\"profiles\")\r\n            .select(\"first_name, last_name\")\r\n            .eq(\"id\", uid)\r\n            .single();\r\n          \r\n          // If profile doesn't have names, try to populate from auth metadata\r\n          if (profileData && !profileData.first_name && !profileData.last_name) {\r\n            const metadata = data.user.user_metadata as { full_name?: string; first_name?: string; last_name?: string };\r\n            if (metadata?.full_name) {\r\n              const nameParts = metadata.full_name.trim().split(/\\s+/);\r\n              const firstName = nameParts[0] || \"\";\r\n              const lastName = nameParts.slice(1).join(\" \") || \"\";\r\n              \r\n              if (firstName || lastName) {\r\n                await supabase\r\n                  .from(\"profiles\")\r\n                  .update({\r\n                    first_name: firstName || null,\r\n                    last_name: lastName || null,\r\n                    updated_at: new Date().toISOString()\r\n                  })\r\n                  .eq(\"id\", uid);\r\n              }\r\n            }\r\n          }\r\n        } catch {\r\n          // Ignore - profile might not exist yet or RLS might prevent update\r\n        }\r\n      }\r\n      \r\n      await loadPosts(uid);\r\n      setLoading(false);\r\n    })();\r\n    const { data: sub } = supabase.auth.onAuthStateChange(async (sessionEvent, session) => {\r\n      const uid = session?.user?.id ?? null;\r\n      setUserId(uid);\r\n      \r\n      // Ensure profile is populated when user logs in\r\n      if (uid && session?.user) {\r\n        try {\r\n          const { data: profileData } = await supabase\r\n            .from(\"profiles\")\r\n            .select(\"first_name, last_name\")\r\n            .eq(\"id\", uid)\r\n            .single();\r\n          \r\n          // If profile doesn't have names, populate from auth metadata\r\n          if (profileData && !profileData.first_name && !profileData.last_name) {\r\n            const metadata = session.user.user_metadata as { full_name?: string; first_name?: string; last_name?: string };\r\n            if (metadata?.full_name) {\r\n              const nameParts = metadata.full_name.trim().split(/\\s+/);\r\n              const firstName = nameParts[0] || \"\";\r\n              const lastName = nameParts.slice(1).join(\" \") || \"\";\r\n              \r\n              if (firstName || lastName) {\r\n                await supabase\r\n                  .from(\"profiles\")\r\n                  .update({\r\n                    first_name: firstName || null,\r\n                    last_name: lastName || null,\r\n                    updated_at: new Date().toISOString()\r\n                  })\r\n                  .eq(\"id\", uid);\r\n              }\r\n            } else if (metadata?.first_name || metadata?.last_name) {\r\n              await supabase\r\n                .from(\"profiles\")\r\n                .update({\r\n                  first_name: metadata.first_name || null,\r\n                  last_name: metadata.last_name || null,\r\n                  updated_at: new Date().toISOString()\r\n                })\r\n                .eq(\"id\", uid);\r\n            }\r\n          }\r\n        } catch {\r\n          // Ignore - profile might not exist yet or RLS might prevent update\r\n        }\r\n      }\r\n      \r\n      await loadPosts(uid);\r\n    });\r\n    return () => {\r\n      mounted = false;\r\n      sub.subscription.unsubscribe();\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  async function loadPosts(currentUserId: string | null = userId) {\r\n    const { data, error } = await supabase\r\n      .from(\"posts\")\r\n      .select(\r\n        `id, user_id, content, image_url, created_at, profiles(id, first_name, last_name, avatar_url),\r\n         likes_count:likes(count), comments_count:comments(count)`\r\n      )\r\n      .order(\"created_at\", { ascending: false });\r\n\r\n    if (error) {\r\n      console.error(\"Error loading posts:\", error);\r\n      return;\r\n    }\r\n\r\n    const normalized = (data as any[]).map((row) => ({\r\n      ...row,\r\n      profiles: extractProfile(row.profiles),\r\n      likes_count: Array.isArray(row.likes_count) ? row.likes_count[0]?.count ?? 0 : row.likes_count ?? 0,\r\n      comments_count: Array.isArray(row.comments_count) ? row.comments_count[0]?.count ?? 0 : row.comments_count ?? 0,\r\n      liked_by_me: false,\r\n    })) as Post[];\r\n\r\n    // If profiles are missing (likely due to RLS), try to fetch them separately\r\n    const missingProfileUserIds = normalized\r\n      .filter((p) => !p.profiles || (!p.profiles.first_name && !p.profiles.last_name))\r\n      .map((p) => p.user_id)\r\n      .filter((id, index, self) => self.indexOf(id) === index); // unique IDs\r\n    \r\n    if (missingProfileUserIds.length > 0) {\r\n    const { data: profilesData, error: profilesError } = await supabase\r\n        .from(\"profiles\")\r\n        .select(\"id, first_name, last_name, avatar_url\")\r\n        .in(\"id\", missingProfileUserIds);\r\n      \r\n      if (!profilesError && profilesData) {\r\n        const profilesMap = new Map(profilesData.map(p => [p.id, p]));\r\n        for (const post of normalized) {\r\n          if (!post.profiles || (!post.profiles.first_name && !post.profiles.last_name)) {\r\n            const profile = profilesMap.get(post.user_id);\r\n            if (profile) {\r\n              post.profiles = profile as Profile;\r\n            }\r\n          }\r\n        }\r\n      } else if (profilesError) {\r\n        console.error(\"Error fetching profiles separately:\", profilesError);\r\n      }\r\n    }\r\n\r\n    if (currentUserId && normalized.length) {\r\n      const postIds = normalized.map((p) => p.id);\r\n      const { data: myLikes, error: likesErr } = await supabase\r\n        .from(\"likes\")\r\n        .select(\"post_id\")\r\n        .eq(\"user_id\", currentUserId)\r\n        .in(\"post_id\", postIds);\r\n      if (!likesErr && myLikes) {\r\n        const likedSet = new Set(myLikes.map((l: any) => l.post_id));\r\n        for (const p of normalized) p.liked_by_me = likedSet.has(p.id);\r\n      }\r\n    }\r\n\r\n    setPosts(normalized);\r\n  }\r\n\r\n  async function submitPost(e: React.FormEvent) {\r\n    e.preventDefault();\r\n    if (!userId) {\r\n      window.location.href = \"/auth/login?next=/community\";\r\n      return;\r\n    }\r\n    \r\n    // Prevent double submission\r\n    if (submitting) {\r\n      return;\r\n    }\r\n    \r\n    // Validate that we have either content or images\r\n    if (!content.trim() && imageFiles.length === 0) {\r\n      alert(\"Please add a caption or an image to post.\");\r\n      return;\r\n    }\r\n    \r\n    // Require image for community page\r\n    if (imageFiles.length === 0) {\r\n      alert(\"Please add at least one image to post in the community page.\");\r\n      return;\r\n    }\r\n    \r\n    setSubmitting(true);\r\n    const imageUrls: string[] = [];\r\n\r\n    try {\r\n      // Ensure user has a profile before posting (to satisfy foreign key constraint)\r\n      const { data: profileData, error: profileError } = await supabase\r\n        .from(\"profiles\")\r\n        .select(\"id\")\r\n        .eq(\"id\", userId)\r\n        .maybeSingle();\r\n      \r\n      if (profileError && profileError.code !== 'PGRST116') {\r\n        console.error(\"Error checking profile:\", profileError);\r\n      }\r\n      \r\n      // Create a basic profile if it doesn't exist\r\n      if (!profileData) {\r\n        const { error: createProfileError } = await supabase\r\n          .from(\"profiles\")\r\n          .upsert({\r\n            id: userId,\r\n            first_name: null,\r\n            last_name: null,\r\n            created_at: new Date().toISOString(),\r\n            updated_at: new Date().toISOString()\r\n          }, { onConflict: \"id\" });\r\n        \r\n        if (createProfileError) {\r\n          console.error(\"Error creating profile:\", createProfileError);\r\n          // Continue anyway - might work if RLS allows it\r\n        }\r\n      }\r\n      \r\n      // Upload all images\r\n      if (imageFiles.length > 0) {\r\n        try {\r\n          for (const imageFile of imageFiles) {\r\n            const ext = imageFile.name.split(\".\").pop()?.toLowerCase() || \"jpg\";\r\n            const path = `${userId}/${Date.now()}-${Math.random().toString(36).slice(2)}.${ext}`;\r\n            \r\n            const { error: upErr } = await supabase\r\n              .storage\r\n              .from(\"post-images\")\r\n              .upload(path, imageFile, {\r\n                cacheControl: \"3600\",\r\n                upsert: false,\r\n                contentType: imageFile.type || \"image/jpeg\",\r\n              });\r\n            \r\n            if (upErr) {\r\n              console.error(\"Upload error:\", upErr);\r\n              throw new Error(`Failed to upload image: ${upErr.message}`);\r\n            }\r\n            \r\n            const { data: pub } = supabase.storage.from(\"post-images\").getPublicUrl(path);\r\n            imageUrls.push(pub.publicUrl);\r\n          }\r\n        } catch (uploadErr: any) {\r\n          console.error(\"Image upload failed:\", uploadErr);\r\n          throw new Error(`Image upload failed: ${uploadErr.message || \"Unknown error\"}`);\r\n        }\r\n      }\r\n      \r\n      // Insert post with JSON array of image URLs (or single URL for backward compatibility)\r\n      const imageUrlValue = imageUrls.length === 1 ? imageUrls[0] : JSON.stringify(imageUrls);\r\n      const { error: insertError } = await supabase\r\n        .from(\"posts\")\r\n        .insert({ \r\n          content: content.trim() || \"\", // Use empty string instead of null to satisfy NOT NULL constraint\r\n          image_url: imageUrlValue, \r\n          user_id: userId \r\n        })\r\n        .select()\r\n        .single();\r\n      \r\n      if (insertError) {\r\n        console.error(\"Insert error:\", insertError);\r\n        // Better error logging\r\n        const errorDetails = insertError.details || insertError.hint || insertError.message || JSON.stringify(insertError);\r\n        throw new Error(`Failed to create post: ${errorDetails}`);\r\n      }\r\n      \r\n      // Success - clear form and reload posts\r\n      setContent(\"\");\r\n      \r\n      // Revoke object URLs to prevent memory leaks\r\n      imagePreviews.forEach(preview => {\r\n        URL.revokeObjectURL(preview);\r\n      });\r\n      \r\n      setImageFiles([]);\r\n      setImagePreviews([]);\r\n      setCurrentImageIndex(0);\r\n      \r\n      // Reset file input\r\n      if (fileInputRef.current) {\r\n        fileInputRef.current.value = \"\";\r\n      }\r\n      \r\n      // Reload posts\r\n      await loadPosts(userId);\r\n      setIsComposerOpen(false);\r\n      \r\n    } catch (err: unknown) {\r\n      console.error(\"Error in submitPost:\", err);\r\n      const errorMessage =\r\n        (err as { message?: string; error?: { message?: string } })?.message ||\r\n        (err as { error?: { message?: string } })?.error?.message ||\r\n        \"Failed to post. Please try again.\";\r\n      alert(errorMessage);\r\n      \r\n      // Don't clear form on error - let user retry with same content/images\r\n      // Keep the previews so user can retry\r\n    } finally {\r\n      // Always reset submitting state\r\n      setSubmitting(false);\r\n    }\r\n  }\r\n\r\n  async function toggleLike(post: Post) {\r\n    if (!userId) {\r\n      window.location.href = \"/auth/login?next=/community\";\r\n      return;\r\n    }\r\n    \r\n    const wasLiked = post.liked_by_me;\r\n    \r\n    // Optimistic update first\r\n    if (selectedPost && selectedPost.id === post.id) {\r\n      setSelectedPost({\r\n        ...selectedPost,\r\n        liked_by_me: !wasLiked,\r\n        likes_count: Math.max(0, (selectedPost.likes_count ?? 0) + (wasLiked ? -1 : 1))\r\n      });\r\n    }\r\n    \r\n    try {\r\n      if (wasLiked) {\r\n        const { error } = await supabase.from(\"likes\").delete().match({ post_id: post.id, user_id: userId });\r\n        if (error) {\r\n          console.error(\"Error unliking post:\", error);\r\n          alert(error.message);\r\n          // Revert optimistic update on error\r\n          if (selectedPost && selectedPost.id === post.id) {\r\n            setSelectedPost({\r\n              ...selectedPost,\r\n              liked_by_me: wasLiked,\r\n              likes_count: (selectedPost.likes_count ?? 0)\r\n            });\r\n          }\r\n          return;\r\n        }\r\n      } else {\r\n        // Check if like already exists to avoid duplicate key errors\r\n        const { data: existingLike } = await supabase\r\n          .from(\"likes\")\r\n          .select(\"id\")\r\n          .eq(\"post_id\", post.id)\r\n          .eq(\"user_id\", userId)\r\n          .maybeSingle();\r\n        \r\n        if (!existingLike) {\r\n          const { error } = await supabase\r\n            .from(\"likes\")\r\n            .insert({ post_id: post.id, user_id: userId });\r\n          if (error) {\r\n            console.error(\"Error liking post:\", error);\r\n            alert(error.message);\r\n            // Revert optimistic update on error\r\n            if (selectedPost && selectedPost.id === post.id) {\r\n              setSelectedPost({\r\n                ...selectedPost,\r\n                liked_by_me: wasLiked,\r\n                likes_count: (selectedPost.likes_count ?? 0)\r\n              });\r\n            }\r\n            return;\r\n          }\r\n        }\r\n      }\r\n      \r\n      // Reload posts to get accurate counts\r\n      await loadPosts(userId);\r\n      \r\n      // Update selectedPost with fresh data\r\n      const updatedPosts = await supabase\r\n        .from(\"posts\")\r\n        .select(\r\n          `id, user_id, content, image_url, created_at, profiles(id, first_name, last_name, avatar_url),\r\n           likes_count:likes(count), comments_count:comments(count)`\r\n        )\r\n        .eq(\"id\", post.id)\r\n        .single();\r\n      \r\n      if (updatedPosts.data && selectedPost && selectedPost.id === post.id) {\r\n        const normalized = {\r\n          ...updatedPosts.data,\r\n          profiles: extractProfile(updatedPosts.data.profiles),\r\n          likes_count: Array.isArray(updatedPosts.data.likes_count) ? updatedPosts.data.likes_count[0]?.count ?? 0 : updatedPosts.data.likes_count ?? 0,\r\n          comments_count: Array.isArray(updatedPosts.data.comments_count) ? updatedPosts.data.comments_count[0]?.count ?? 0 : updatedPosts.data.comments_count ?? 0,\r\n          liked_by_me: false,\r\n        } as Post;\r\n        \r\n        // Check if user liked this post\r\n        const { data: myLike } = await supabase\r\n          .from(\"likes\")\r\n          .select(\"post_id\")\r\n          .eq(\"post_id\", post.id)\r\n          .eq(\"user_id\", userId)\r\n          .maybeSingle();\r\n        \r\n        normalized.liked_by_me = !!myLike;\r\n        setSelectedPost(normalized);\r\n      }\r\n    } catch (error: any) {\r\n      console.error(\"Error in toggleLike:\", error);\r\n      alert(error?.message || \"Failed to update like. Please try again.\");\r\n    }\r\n  }\r\n\r\n  async function loadComments(postId: string) {\r\n    const { data, error } = await supabase\r\n      .from(\"comments\")\r\n      .select(\"id, post_id, user_id, content, created_at, profiles(id, first_name, last_name, avatar_url)\")\r\n      .eq(\"post_id\", postId)\r\n      .order(\"created_at\", { ascending: true });\r\n    \r\n    if (error) {\r\n      console.error(\"Error loading comments:\", error);\r\n      return alert(error.message);\r\n    }\r\n    \r\n    const normalizedComments = (data as any[]).map((comment) => ({\r\n      ...comment,\r\n      profiles: extractProfile(comment.profiles),\r\n    })) as Comment[];\r\n    \r\n    // If profiles are missing, try to fetch them separately\r\n    const missingProfileUserIds = normalizedComments\r\n      .filter(c => !c.profiles || (!c.profiles.first_name && !c.profiles.last_name))\r\n      .map(c => c.user_id)\r\n      .filter((id, index, self) => self.indexOf(id) === index); // unique IDs\r\n    \r\n    if (missingProfileUserIds.length > 0) {\r\n      const { data: profilesData, error: profilesError } = await supabase\r\n        .from(\"profiles\")\r\n        .select(\"id, first_name, last_name, avatar_url\")\r\n        .in(\"id\", missingProfileUserIds);\r\n      \r\n      if (!profilesError && profilesData) {\r\n        const profilesMap = new Map(profilesData.map(p => [p.id, p]));\r\n        for (const comment of normalizedComments) {\r\n          if (!comment.profiles || (!comment.profiles.first_name && !comment.profiles.last_name)) {\r\n            const profile = profilesMap.get(comment.user_id);\r\n            if (profile) {\r\n              comment.profiles = profile as Profile;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    \r\n    setCommentsByPost((prev) => ({ ...prev, [postId]: normalizedComments || [] }));\r\n  }\r\n\r\n  async function deletePost(postId: string) {\r\n    if (!userId) {\r\n      alert(\"You must be logged in to delete a post.\");\r\n      return;\r\n    }\r\n    \r\n    if (deletingPost === postId) {\r\n      return; // Already deleting\r\n    }\r\n    \r\n    if (!confirm(\"Are you sure you want to delete this post? This action cannot be undone.\")) {\r\n      return;\r\n    }\r\n    \r\n    setDeletingPost(postId);\r\n    \r\n    try {\r\n      // First, delete all related data (likes and comments)\r\n      const { error: likesError } = await supabase.from(\"likes\").delete().eq(\"post_id\", postId);\r\n      if (likesError) {\r\n        console.warn(\"Error deleting likes (continuing anyway):\", likesError);\r\n      }\r\n      \r\n      const { error: commentsError } = await supabase.from(\"comments\").delete().eq(\"post_id\", postId);\r\n      if (commentsError) {\r\n        console.warn(\"Error deleting comments (continuing anyway):\", commentsError);\r\n      }\r\n      \r\n      // Delete the post image from storage if it exists\r\n      const { data: postData, error: fetchError } = await supabase\r\n        .from(\"posts\")\r\n        .select(\"image_url, user_id\")\r\n        .eq(\"id\", postId)\r\n        .single();\r\n      \r\n      if (fetchError) {\r\n        console.error(\"Error fetching post data:\", fetchError);\r\n        throw new Error(`Failed to fetch post: ${fetchError.message}`);\r\n      }\r\n      \r\n      // Verify ownership\r\n      if (postData.user_id !== userId) {\r\n        alert(\"You can only delete your own posts.\");\r\n        return;\r\n      }\r\n      \r\n      if (postData?.image_url) {\r\n        // Handle both single URL and JSON array of URLs\r\n        let imageUrls: string[] = [];\r\n        try {\r\n          const parsed = JSON.parse(postData.image_url);\r\n          if (Array.isArray(parsed)) {\r\n            imageUrls = parsed;\r\n          } else {\r\n            imageUrls = [postData.image_url];\r\n          }\r\n        } catch {\r\n          imageUrls = [postData.image_url];\r\n        }\r\n        \r\n        // Delete all images from storage\r\n        const filePaths: string[] = [];\r\n        for (const imageUrl of imageUrls) {\r\n          const urlParts = imageUrl.split(\"/post-images/\");\r\n          if (urlParts.length > 1) {\r\n            const filePath = urlParts[1].split(\"?\")[0];\r\n            filePaths.push(filePath);\r\n          }\r\n        }\r\n        \r\n        if (filePaths.length > 0) {\r\n          const { error: storageError } = await supabase.storage.from(\"post-images\").remove(filePaths);\r\n          if (storageError) {\r\n            console.warn(\"Error deleting images from storage (continuing anyway):\", storageError);\r\n          }\r\n        }\r\n      }\r\n      \r\n      // Delete the post\r\n      const { error, data } = await supabase\r\n        .from(\"posts\")\r\n        .delete()\r\n        .eq(\"id\", postId)\r\n        .eq(\"user_id\", userId)\r\n        .select();\r\n      \r\n      if (error) {\r\n        console.error(\"Error deleting post:\", error);\r\n        throw new Error(`Failed to delete post: ${error.message}`);\r\n      }\r\n      \r\n      if (!data || data.length === 0) {\r\n        throw new Error(\"Post not found or you don't have permission to delete it.\");\r\n      }\r\n      \r\n      // Close modal if the deleted post was open\r\n      if (selectedPost && selectedPost.id === postId) {\r\n        closeModal();\r\n      }\r\n      \r\n      // Reload posts\r\n      await loadPosts(userId);\r\n    } catch (error: any) {\r\n      console.error(\"Error deleting post:\", error);\r\n      alert(error?.message || \"Failed to delete post. Please try again.\");\r\n    } finally {\r\n      setDeletingPost(null);\r\n    }\r\n  }\r\n\r\n  async function deleteComment(commentId: string, postId: string) {\r\n    if (!userId) {\r\n      alert(\"You must be logged in to delete a comment.\");\r\n      return;\r\n    }\r\n    \r\n    if (deletingComment === commentId) {\r\n      return; // Already deleting\r\n    }\r\n    \r\n    if (!confirm(\"Are you sure you want to delete this comment?\")) {\r\n      return;\r\n    }\r\n    \r\n    setDeletingComment(commentId);\r\n    \r\n    try {\r\n      // First verify ownership\r\n      const { data: commentData, error: fetchError } = await supabase\r\n        .from(\"comments\")\r\n        .select(\"id, user_id\")\r\n        .eq(\"id\", commentId)\r\n        .single();\r\n      \r\n      if (fetchError) {\r\n        console.error(\"Error fetching comment:\", fetchError);\r\n        throw new Error(`Failed to fetch comment: ${fetchError.message}`);\r\n      }\r\n      \r\n      if (!commentData) {\r\n        throw new Error(\"Comment not found.\");\r\n      }\r\n      \r\n      // Verify ownership\r\n      if (commentData.user_id !== userId) {\r\n        alert(\"You can only delete your own comments.\");\r\n        return;\r\n      }\r\n      \r\n      // Delete the comment\r\n      const { error, data } = await supabase\r\n        .from(\"comments\")\r\n        .delete()\r\n        .eq(\"id\", commentId)\r\n        .eq(\"user_id\", userId)\r\n        .select();\r\n      \r\n      if (error) {\r\n        console.error(\"Error deleting comment:\", error);\r\n        throw new Error(`Failed to delete comment: ${error.message}`);\r\n      }\r\n      \r\n      if (!data || data.length === 0) {\r\n        throw new Error(\"Comment not found or you don't have permission to delete it.\");\r\n      }\r\n      \r\n      // Reload comments and update post count\r\n      await loadComments(postId);\r\n      await loadPosts(userId);\r\n      \r\n      // Update selectedPost if it's the same post\r\n      if (selectedPost && selectedPost.id === postId) {\r\n        const updatedPost = posts.find(p => p.id === postId);\r\n        if (updatedPost) {\r\n          setSelectedPost({\r\n            ...updatedPost,\r\n            comments_count: Math.max(0, (updatedPost.comments_count ?? 0) - 1)\r\n          });\r\n        }\r\n      }\r\n    } catch (error: any) {\r\n      console.error(\"Error deleting comment:\", error);\r\n      alert(error?.message || \"Failed to delete comment. Please try again.\");\r\n    } finally {\r\n      setDeletingComment(null);\r\n    }\r\n  }\r\n\r\n  async function submitComment(postId: string) {\r\n    if (!userId) {\r\n      window.location.href = \"/auth/login?next=/community\";\r\n      return;\r\n    }\r\n    \r\n    const text = (newCommentContent[postId] || \"\").trim();\r\n    if (!text) {\r\n      alert(\"Please enter a comment\");\r\n      return;\r\n    }\r\n    \r\n    // Optimistic update\r\n    const previousCount = selectedPost?.comments_count ?? 0;\r\n    if (selectedPost && selectedPost.id === postId) {\r\n      setSelectedPost({\r\n        ...selectedPost,\r\n        comments_count: previousCount + 1\r\n      });\r\n    }\r\n    \r\n    // Clear input immediately\r\n    setNewCommentContent((p) => ({ ...p, [postId]: \"\" }));\r\n    \r\n    try {\r\n      const { error } = await supabase\r\n        .from(\"comments\")\r\n        .insert({ post_id: postId, content: text, user_id: userId })\r\n        .select()\r\n        .single();\r\n      \r\n      if (error) {\r\n        console.error(\"Error submitting comment:\", error);\r\n        alert(error.message);\r\n        // Revert optimistic update on error\r\n        if (selectedPost && selectedPost.id === postId) {\r\n          setSelectedPost({\r\n            ...selectedPost,\r\n            comments_count: previousCount\r\n          });\r\n        }\r\n        // Restore input text\r\n        setNewCommentContent((p) => ({ ...p, [postId]: text }));\r\n        return;\r\n      }\r\n      \r\n      // Reload comments to show the new one\r\n      await loadComments(postId);\r\n      \r\n      // Reload posts to get accurate comment count\r\n      await loadPosts(userId);\r\n      \r\n      // Update selectedPost with fresh data\r\n      const updatedPosts = await supabase\r\n        .from(\"posts\")\r\n        .select(\r\n          `id, user_id, content, image_url, created_at, profiles(id, first_name, last_name, avatar_url),\r\n           likes_count:likes(count), comments_count:comments(count)`\r\n        )\r\n        .eq(\"id\", postId)\r\n        .single();\r\n      \r\n      if (updatedPosts.data && selectedPost && selectedPost.id === postId) {\r\n        const normalized = {\r\n          ...updatedPosts.data,\r\n          profiles: extractProfile(updatedPosts.data.profiles),\r\n          likes_count: Array.isArray(updatedPosts.data.likes_count) ? updatedPosts.data.likes_count[0]?.count ?? 0 : updatedPosts.data.likes_count ?? 0,\r\n          comments_count: Array.isArray(updatedPosts.data.comments_count) ? updatedPosts.data.comments_count[0]?.count ?? 0 : updatedPosts.data.comments_count ?? 0,\r\n          liked_by_me: selectedPost.liked_by_me, // Preserve like status\r\n        } as Post;\r\n        \r\n        setSelectedPost(normalized);\r\n      }\r\n    } catch (error: any) {\r\n      console.error(\"Error in submitComment:\", error);\r\n      alert(error?.message || \"Failed to post comment. Please try again.\");\r\n      // Revert optimistic update on error\r\n      if (selectedPost && selectedPost.id === postId) {\r\n        setSelectedPost({\r\n          ...selectedPost,\r\n          comments_count: previousCount\r\n        });\r\n      }\r\n      // Restore input text\r\n      setNewCommentContent((p) => ({ ...p, [postId]: text }));\r\n    }\r\n  }\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  function toggleExpanded(postId: string) {\r\n    setExpandedPostIds((prev) => {\r\n      const next = new Set(prev);\r\n      if (next.has(postId)) next.delete(postId);\r\n      else next.add(postId);\r\n      return next;\r\n    });\r\n    if (!commentsByPost[postId]) void loadComments(postId);\r\n  }\r\n\r\n  function openPostModal(post: Post) {\r\n    setSelectedPost(post);\r\n    setIsModalOpen(true);\r\n    // Reset image index when opening modal\r\n    setCurrentPostImageIndex(prev => ({ ...prev, [post.id]: 0 }));\r\n    if (!commentsByPost[post.id]) {\r\n      void loadComments(post.id);\r\n    }\r\n  }\r\n\r\n  function closeModal() {\r\n    setIsModalOpen(false);\r\n    setSelectedPost(null);\r\n  }\r\n\r\n  // Helper function to get image URLs from a post (handles both single URL and JSON array)\r\n  const getPostImages = (post: Post): string[] => {\r\n    if (!post.image_url) return [];\r\n    try {\r\n      // Try to parse as JSON array\r\n      const parsed = JSON.parse(post.image_url);\r\n      if (Array.isArray(parsed)) {\r\n        return parsed;\r\n      }\r\n    } catch {\r\n      // If not JSON, treat as single URL string\r\n    }\r\n    return [post.image_url];\r\n  };\r\n\r\n  // Filter posts to only show those with images\r\n  const postsWithImages = useMemo(() => {\r\n    return posts.filter(post => post.image_url);\r\n  }, [posts]);\r\n\r\n  // Sync selectedPost with updated posts when posts change (for accurate counts)\r\n  useEffect(() => {\r\n    if (selectedPost && isModalOpen && posts.length > 0) {\r\n      const updatedPost = posts.find(p => p.id === selectedPost.id);\r\n      if (updatedPost) {\r\n        // Only update if the post data has actually changed (to avoid unnecessary re-renders)\r\n        if (updatedPost.likes_count !== selectedPost.likes_count || \r\n            updatedPost.comments_count !== selectedPost.comments_count ||\r\n            updatedPost.liked_by_me !== selectedPost.liked_by_me) {\r\n          setSelectedPost(updatedPost);\r\n        }\r\n      }\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [posts, isModalOpen]);\r\n\r\n  // Handle paste image functionality\r\n  useEffect(() => {\r\n    const handlePaste = async (e: ClipboardEvent) => {\r\n      if (!userId || submitting) return;\r\n      \r\n      const items = e.clipboardData?.items;\r\n      if (!items) return;\r\n\r\n      // Look for image in clipboard\r\n      for (let i = 0; i < items.length; i++) {\r\n        const item = items[i];\r\n        \r\n        // Check if the item is an image\r\n        if (item.type.indexOf('image') !== -1) {\r\n          e.preventDefault();\r\n          \r\n          const file = item.getAsFile();\r\n          if (file) {\r\n            // Validate file type\r\n            if (!file.type.startsWith('image/')) {\r\n              alert('Please paste an image file');\r\n              return;\r\n            }\r\n            \r\n            // Validate file size (max 10MB)\r\n            if (file.size > 10 * 1024 * 1024) {\r\n              alert('Image is too large. Maximum size is 10MB');\r\n              return;\r\n            }\r\n            \r\n            // Add to images array\r\n            setImageFiles(prev => [...prev, file]);\r\n            setImagePreviews(prev => [...prev, URL.createObjectURL(file)]);\r\n            \r\n            // Reset file input if it exists\r\n            if (fileInputRef.current) {\r\n              fileInputRef.current.value = \"\";\r\n            }\r\n          }\r\n          break;\r\n        }\r\n      }\r\n    };\r\n\r\n    // Add paste event listener to the document\r\n    document.addEventListener('paste', handlePaste);\r\n    \r\n    return () => {\r\n      document.removeEventListener('paste', handlePaste);\r\n    };\r\n  }, [userId, submitting]);\r\n\r\n  // Cleanup object URLs on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      imagePreviews.forEach(preview => {\r\n        URL.revokeObjectURL(preview);\r\n      });\r\n    };\r\n  }, [imagePreviews]);\r\n\r\n  const handleOpenComposer = () => {\r\n    if (!userId) {\r\n      window.location.href = \"/auth/login?next=/community\";\r\n      return;\r\n    }\r\n    setIsComposerOpen(true);\r\n  };\r\n\r\n  const handleCloseComposer = () => {\r\n    // Clean up previews when closing\r\n    imagePreviews.forEach(preview => {\r\n      URL.revokeObjectURL(preview);\r\n    });\r\n    setImageFiles([]);\r\n    setImagePreviews([]);\r\n    setCurrentImageIndex(0);\r\n    setIsComposerOpen(false);\r\n  };\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  const nextImage = () => {\r\n    setCurrentImageIndex((prev) => (prev + 1) % imagePreviews.length);\r\n  };\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  const prevImage = () => {\r\n    setCurrentImageIndex((prev) => (prev - 1 + imagePreviews.length) % imagePreviews.length);\r\n  };\r\n\r\n  const nextPostImage = (postId: string, totalImages: number) => {\r\n    setCurrentPostImageIndex((prev) => ({\r\n      ...prev,\r\n      [postId]: ((prev[postId] || 0) + 1) % totalImages\r\n    }));\r\n  };\r\n\r\n  const prevPostImage = (postId: string, totalImages: number) => {\r\n    setCurrentPostImageIndex((prev) => ({\r\n      ...prev,\r\n      [postId]: ((prev[postId] || 0) - 1 + totalImages) % totalImages\r\n    }));\r\n  };\r\n\r\n  const removeImage = (index: number) => {\r\n    setImageFiles(prev => prev.filter((_, i) => i !== index));\r\n    URL.revokeObjectURL(imagePreviews[index]);\r\n    setImagePreviews(prev => prev.filter((_, i) => i !== index));\r\n    if (currentImageIndex >= imagePreviews.length - 1 && currentImageIndex > 0) {\r\n      setCurrentImageIndex(currentImageIndex - 1);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 animate-fade-in\">\r\n      <div className=\"container max-w-7xl py-6\">\r\n        <h1 className=\"text-3xl font-bold mb-6 text-gray-900 animate-fade-in-down\">Community</h1>\r\n\r\n        {/* Pinterest-style Masonry Grid */}\r\n        {loading ? (\r\n          <div className=\"text-center text-gray-500 py-12\">\r\n            <div className=\"loading-spinner mx-auto mb-4\"></div>\r\n            <p>Loadingâ€¦</p>\r\n          </div>\r\n        ) : postsWithImages.length === 0 ? (\r\n          <div className=\"text-center text-gray-500 py-12\">\r\n            <p className=\"text-lg mb-2\">No posts with images yet.</p>\r\n            <p className=\"text-sm\">Be the first to share a photo!</p>\r\n          </div>\r\n        ) : (\r\n          <div \r\n            className=\"columns-1 sm:columns-2 md:columns-3 lg:columns-4 xl:columns-5 gap-4\"\r\n            style={{ columnFill: 'balance' }}\r\n          >\r\n            {postsWithImages.map((post, index) => (\r\n              <div\r\n                key={post.id}\r\n                className={`break-inside-avoid mb-4 bg-white rounded-lg overflow-hidden shadow-sm card-hover cursor-pointer border border-gray-200 stagger-item group`}\r\n                style={{ animationDelay: `${index * 0.05}s` }}\r\n                onClick={() => openPostModal(post)}\r\n              >\r\n                {(() => {\r\n                  const postImages = getPostImages(post);\r\n                  // Always show first image in grid view (no navigation)\r\n                  const currentIndex = 0;\r\n                  return postImages.length > 0 && (\r\n                    <div className=\"relative w-full\">\r\n                      <div className=\"relative bg-gray-100 overflow-hidden\">\r\n                        {postImages.map((imgUrl, index) => (\r\n                          <img\r\n                            key={index}\r\n                            src={imgUrl}\r\n                            alt={post.content || `Post image ${index + 1}`}\r\n                            className={`w-full h-auto transition-opacity duration-300 ${\r\n                              index === currentIndex ? 'opacity-100 block' : 'opacity-0 hidden'\r\n                            }`}\r\n                            loading=\"lazy\"\r\n                          />\r\n                        ))}\r\n                      </div>\r\n                      \r\n                      {/* Dots Indicator - Only show if multiple images */}\r\n                      {postImages.length > 1 && (\r\n                        <div className=\"absolute top-2 right-2 flex items-center gap-1.5 z-10\">\r\n                          {postImages.map((_, index) => (\r\n                            <div\r\n                              key={index}\r\n                              className={`h-1.5 rounded-full transition-all ${\r\n                                index === currentIndex\r\n                                  ? 'bg-white w-4'\r\n                                  : 'bg-white/50 w-1.5'\r\n                              }`}\r\n                            />\r\n                          ))}\r\n                        </div>\r\n                      )}\r\n                      \r\n                      {/* Overlay with likes and comments count */}\r\n                      <div className=\"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-3 pointer-events-none\">\r\n                        <div className=\"flex items-center gap-4 text-white text-sm\">\r\n                          <div className=\"flex items-center gap-1\">\r\n                            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill={post.liked_by_me ? \"currentColor\" : \"none\"} stroke=\"currentColor\" strokeWidth=\"2\">\r\n                              <path d=\"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z\"/>\r\n                            </svg>\r\n                            <span>{post.likes_count ?? 0}</span>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-1\">\r\n                            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                              <path d=\"M21 15a2 2 0 01-2 2H8l-4 4V5a2 2 0 012-2h13a2 2 0 012 2v10z\"/>\r\n                            </svg>\r\n                            <span>{post.comments_count ?? 0}</span>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  );\r\n                })()}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {/* Floating Create Button */}\r\n        <button\r\n          type=\"button\"\r\n          onClick={handleOpenComposer}\r\n          className=\"fixed bottom-6 right-6 w-14 h-14 rounded-full bg-[#8c52ff] text-white shadow-lg hover:scale-105 transition-transform z-50 flex items-center justify-center\"\r\n          aria-label=\"Create community post\"\r\n        >\r\n          <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n            <path d=\"M12 5v14M5 12h14\"/>\r\n          </svg>\r\n        </button>\r\n\r\n        {/* Composer Modal */}\r\n        <Modal open={isComposerOpen} onClose={handleCloseComposer} title=\"Share something\" className=\"max-w-2xl\">\r\n          <form onSubmit={submitPost} className=\"bg-white space-y-4\">\r\n            <div className=\"rounded-2xl border border-gray-200 bg-gray-50 px-4 py-3 shadow-inner\">\r\n              <textarea\r\n                value={content}\r\n                onChange={(e) => setContent(e.target.value)}\r\n                placeholder={userId ? \"Share something with the community... (You can paste an image here!)\" : \"Sign in to post\"}\r\n                className=\"w-full resize-none rounded-xl border border-transparent bg-white/80 p-4 text-gray-900 placeholder:text-gray-500 focus:border-[#c9adff] focus:ring-2 focus:ring-[#d9c5ff] min-h-[160px]\"\r\n                disabled={!userId || submitting}\r\n                onPaste={(e) => {\r\n                  const items = e.clipboardData?.items;\r\n                  if (items) {\r\n                    for (let i = 0; i < items.length; i++) {\r\n                      if (items[i].type.indexOf('image') !== -1) {\r\n                        e.preventDefault();\r\n                        return;\r\n                      }\r\n                    }\r\n                  }\r\n                }}\r\n              />\r\n              <div className=\"mt-2 text-right text-xs text-gray-500\">{content.length}/280</div>\r\n            </div>\r\n            {imagePreviews.length > 0 && (\r\n              <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-3\">\r\n                <div className=\"flex items-center gap-2 mb-2\">\r\n                  <span className=\"text-sm font-medium text-gray-700\">{imagePreviews.length} image{imagePreviews.length > 1 ? 's' : ''} selected</span>\r\n                </div>\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                  {imagePreviews.map((preview, index) => (\r\n                    <div\r\n                      key={index}\r\n                      className=\"relative w-20 h-20 rounded-lg overflow-hidden border-2 border-gray-300 bg-gray-100 group\"\r\n                    >\r\n                      <img\r\n                        src={preview}\r\n                        alt={`Preview ${index + 1}`}\r\n                        className=\"w-full h-full object-cover\"\r\n                      />\r\n                      {/* Remove button */}\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          removeImage(index);\r\n                        }}\r\n                        className=\"absolute top-0.5 right-0.5 w-5 h-5 rounded-full bg-red-500 hover:bg-red-600 text-white flex items-center justify-center transition-colors opacity-0 group-hover:opacity-100\"\r\n                        aria-label=\"Remove image\"\r\n                      >\r\n                        <svg width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"3\">\r\n                          <path d=\"M18 6L6 18M6 6l12 12\"/>\r\n                        </svg>\r\n                      </button>\r\n                      {/* Image number badge */}\r\n                      {imagePreviews.length > 1 && (\r\n                        <div className=\"absolute bottom-0.5 left-0.5 px-1.5 py-0.5 rounded bg-black/50 text-white text-xs font-medium\">\r\n                          {index + 1}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n            <div className=\"flex flex-wrap items-center justify-between gap-3\">\r\n              <label className=\"inline-flex items-center gap-3 rounded-full border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 cursor-pointer transition\">\r\n                <input\r\n                  ref={fileInputRef}\r\n                  type=\"file\"\r\n                  accept=\"image/*\"\r\n                  multiple\r\n                  className=\"hidden\"\r\n                  disabled={!userId || submitting}\r\n                  onChange={(e) => {\r\n                    const files = Array.from(e.target.files || []);\r\n                    if (files.length > 0) {\r\n                      const newPreviews = files.map(file => URL.createObjectURL(file));\r\n                      setImageFiles(prev => [...prev, ...files]);\r\n                      setImagePreviews(prev => [...prev, ...newPreviews]);\r\n                    }\r\n                  }}\r\n                />\r\n                <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                  <path d=\"M4 16l6-6 4 4 6-6\"/>\r\n                  <path d=\"M2 12l2-2 4 4 4-4 6 6 4-4\"/>\r\n                </svg>\r\n                <span>{imageFiles.length > 0 ? `${imageFiles.length} image${imageFiles.length > 1 ? 's' : ''}` : \"Add images\"}</span>\r\n              </label>\r\n              <div className=\"flex items-center gap-3\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleCloseComposer}\r\n                  className=\"px-4 h-10 rounded-full border border-gray-300 text-gray-600 hover:bg-gray-50\"\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  type=\"submit\"\r\n                  disabled={!userId || submitting || content.length > 280 || imageFiles.length === 0}\r\n                  className=\"px-6 h-10 rounded-full bg-[#8c52ff] text-white disabled:opacity-50 disabled:cursor-not-allowed hover:bg-[#7a46e5] transition-all btn-press btn-ripple\"\r\n                >\r\n                  {submitting ? (\r\n                    <span className=\"flex items-center gap-2\">\r\n                      <div className=\"loading-spinner\" style={{ width: '16px', height: '16px', borderWidth: '2px' }}></div>\r\n                      Posting...\r\n                    </span>\r\n                  ) : \"Post\"}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </form>\r\n        </Modal>\r\n\r\n        {/* Post Detail Modal */}\r\n        <Modal open={isModalOpen} onClose={closeModal} title=\"\" className=\"max-w-5xl p-0\" showCloseButton={false}>\r\n          {selectedPost && (\r\n            <div className=\"w-full bg-white rounded-lg overflow-hidden\">\r\n              {/* Close button in top right */}\r\n              <button \r\n                onClick={closeModal} \r\n                className=\"absolute top-4 right-4 z-10 w-8 h-8 rounded-full bg-black/50 hover:bg-black/70 text-white flex items-center justify-center transition-colors\"\r\n                aria-label=\"Close modal\"\r\n              >\r\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                  <path d=\"M18 6L6 18M6 6l12 12\"/>\r\n                </svg>\r\n              </button>\r\n\r\n              <div className=\"flex flex-col md:flex-row max-h-[90vh]\">\r\n                {/* Image Section */}\r\n                {(() => {\r\n                  const postImages = getPostImages(selectedPost);\r\n                  const currentIndex = currentPostImageIndex[selectedPost.id] || 0;\r\n                  return (\r\n                    <div className=\"md:w-1/2 bg-white flex items-center justify-center relative\" style={{ minHeight: '400px', maxHeight: '90vh' }}>\r\n                      {postImages.length > 0 && (\r\n                        <>\r\n                          <div className=\"relative w-full h-full flex items-center justify-center p-4\">\r\n                            {postImages.map((imgUrl, index) => (\r\n                              <img\r\n                                key={index}\r\n                                src={imgUrl}\r\n                                alt={`Post image ${index + 1}`}\r\n                                className={`max-w-full max-h-full w-auto h-auto object-contain transition-opacity duration-300 ${\r\n                                  index === currentIndex ? 'opacity-100' : 'opacity-0 absolute'\r\n                                }`}\r\n                                style={{ maxHeight: 'calc(90vh - 32px)' }}\r\n                              />\r\n                            ))}\r\n                            \r\n                            {/* Navigation Arrows */}\r\n                            {postImages.length > 1 && (\r\n                              <>\r\n                                <button\r\n                                  type=\"button\"\r\n                                  onClick={(e) => {\r\n                                    e.preventDefault();\r\n                                    e.stopPropagation();\r\n                                    prevPostImage(selectedPost.id, postImages.length);\r\n                                  }}\r\n                                  className=\"absolute left-4 top-1/2 -translate-y-1/2 w-10 h-10 rounded-full bg-black/50 hover:bg-black/70 text-white flex items-center justify-center transition-colors z-10\"\r\n                                  aria-label=\"Previous image\"\r\n                                >\r\n                                  <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                                    <path d=\"M15 18l-6-6 6-6\"/>\r\n                                  </svg>\r\n                                </button>\r\n                                <button\r\n                                  type=\"button\"\r\n                                  onClick={(e) => {\r\n                                    e.preventDefault();\r\n                                    e.stopPropagation();\r\n                                    nextPostImage(selectedPost.id, postImages.length);\r\n                                  }}\r\n                                  className=\"absolute right-4 top-1/2 -translate-y-1/2 w-10 h-10 rounded-full bg-black/50 hover:bg-black/70 text-white flex items-center justify-center transition-colors z-10\"\r\n                                  aria-label=\"Next image\"\r\n                                >\r\n                                  <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                                    <path d=\"M9 18l6-6-6-6\"/>\r\n                                  </svg>\r\n                                </button>\r\n                              </>\r\n                            )}\r\n                          </div>\r\n                          \r\n                          {/* Dots Indicator */}\r\n                          {postImages.length > 1 && (\r\n                            <div className=\"absolute bottom-4 left-1/2 -translate-x-1/2 flex items-center gap-2 z-10\">\r\n                              {postImages.map((_, index) => (\r\n                                <button\r\n                                  key={index}\r\n                                  type=\"button\"\r\n                                  onClick={(e) => {\r\n                                    e.preventDefault();\r\n                                    e.stopPropagation();\r\n                                    setCurrentPostImageIndex(prev => ({ ...prev, [selectedPost.id]: index }));\r\n                                  }}\r\n                                  className={`h-2 rounded-full transition-all ${\r\n                                    index === currentIndex\r\n                                      ? 'bg-white w-8'\r\n                                      : 'bg-white/50 hover:bg-white/75 w-2'\r\n                                  }`}\r\n                                  aria-label={`Go to image ${index + 1}`}\r\n                                />\r\n                              ))}\r\n                            </div>\r\n                          )}\r\n                        </>\r\n                      )}\r\n                    </div>\r\n                  );\r\n                })()}\r\n\r\n                {/* Content Section */}\r\n                <div className=\"md:w-1/2 flex flex-col max-h-[90vh] overflow-hidden relative\">\r\n                  {/* Author and Caption Section - Combined */}\r\n                  <div className=\"p-4 border-b border-gray-200 flex items-start gap-3\">\r\n                    {selectedPost.profiles?.avatar_url ? (\r\n                      <img\r\n                        src={selectedPost.profiles.avatar_url}\r\n                        alt={getDisplayName(selectedPost.profiles, selectedPost.user_id)}\r\n                        className=\"w-10 h-10 rounded-full object-cover flex-shrink-0\"\r\n                      />\r\n                    ) : (\r\n                      <div className=\"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-sm font-medium flex-shrink-0 text-gray-900\">\r\n                        {getDisplayName(selectedPost.profiles, selectedPost.user_id).slice(0, 1).toUpperCase()}\r\n                      </div>\r\n                    )}\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <div className=\"flex items-center gap-2 mb-2\">\r\n                        <span className=\"font-semibold text-gray-900 text-sm\">{getDisplayName(selectedPost.profiles, selectedPost.user_id)}</span>\r\n                        <span className=\"text-gray-400\">Â·</span>\r\n                        <time dateTime={selectedPost.created_at} className=\"text-gray-500 text-xs\">\r\n                          {new Date(selectedPost.created_at).toLocaleDateString()}\r\n                        </time>\r\n                        {userId === selectedPost.user_id && (\r\n                          <button\r\n                            type=\"button\"\r\n                            onClick={async (e) => {\r\n                              e.preventDefault();\r\n                              e.stopPropagation();\r\n                              await deletePost(selectedPost.id);\r\n                            }}\r\n                            disabled={deletingPost === selectedPost.id}\r\n                            className=\"text-red-500 hover:text-red-700 transition-colors p-1 rounded-full hover:bg-red-50 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                            title=\"Delete post\"\r\n                          >\r\n                            {deletingPost === selectedPost.id ? (\r\n                              <svg className=\"animate-spin\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                                <path d=\"M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83\"/>\r\n                              </svg>\r\n                            ) : (\r\n                              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                                <path d=\"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2M10 11v6M14 11v6\"/>\r\n                              </svg>\r\n                            )}\r\n                          </button>\r\n                        )}\r\n                      </div>\r\n                      {selectedPost.content ? (\r\n                        <p className=\"whitespace-pre-wrap break-words text-gray-800 text-sm\">{selectedPost.content}</p>\r\n                      ) : null}\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Likes and Comments Actions */}\r\n                  <div className=\"px-4 py-3 border-b border-gray-200\">\r\n                    <div className=\"flex items-center gap-6\">\r\n                      <button \r\n                        type=\"button\"\r\n                        onClick={(e) => {\r\n                          e.preventDefault();\r\n                          e.stopPropagation();\r\n                          toggleLike(selectedPost);\r\n                        }}\r\n                        className={`flex items-center gap-2 transition-colors cursor-pointer hover:scale-105 ${selectedPost.liked_by_me ? \"text-red-500\" : \"text-gray-600 hover:text-red-500\"}`}\r\n                      >\r\n                        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill={selectedPost.liked_by_me ? \"currentColor\" : \"none\"} stroke=\"currentColor\" strokeWidth=\"2\">\r\n                          <path d=\"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z\"/>\r\n                        </svg>\r\n                        <span className=\"font-semibold text-sm\">{selectedPost.likes_count ?? 0} {selectedPost.likes_count === 1 ? 'like' : 'likes'}</span>\r\n                      </button>\r\n                      <div className=\"flex items-center gap-2 text-gray-600\">\r\n                        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                          <path d=\"M21 15a2 2 0 01-2 2H8l-4 4V5a2 2 0 012-2h13a2 2 0 012 2v10z\"/>\r\n                        </svg>\r\n                        <span className=\"font-semibold text-sm\">{selectedPost.comments_count ?? 0} {selectedPost.comments_count === 1 ? 'comment' : 'comments'}</span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Comments Section - Scrollable */}\r\n                  <div className=\"flex-1 overflow-y-auto p-4 space-y-4 min-h-0\">\r\n                    {(commentsByPost[selectedPost.id] || []).length === 0 ? (\r\n                      <div className=\"text-center text-gray-400 py-8\">\r\n                        <p className=\"text-sm\">No comments yet. Be the first to comment!</p>\r\n                      </div>\r\n                    ) : (\r\n                      (commentsByPost[selectedPost.id] || []).map((c) => (\r\n                        <div key={c.id} className=\"flex items-start gap-3 group\">\r\n                          {c.profiles?.avatar_url ? (\r\n                            <img\r\n                              src={c.profiles.avatar_url}\r\n                              alt={getDisplayName(c.profiles, c.user_id)}\r\n                              className=\"w-8 h-8 rounded-full object-cover flex-shrink-0\"\r\n                            />\r\n                          ) : (\r\n                            <div className=\"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-xs font-medium flex-shrink-0 text-gray-900\">\r\n                              {getDisplayName(c.profiles, c.user_id).slice(0, 1).toUpperCase()}\r\n                            </div>\r\n                          )}\r\n                          <div className=\"flex-1 min-w-0\">\r\n                            <div className=\"flex items-center gap-2 mb-1\">\r\n                              <span className=\"font-semibold text-gray-900 text-sm\">{getDisplayName(c.profiles, c.user_id)}</span>\r\n                              <span className=\"text-gray-400\">Â·</span>\r\n                              <time dateTime={c.created_at} className=\"text-gray-500 text-xs\">\r\n                                {new Date(c.created_at).toLocaleDateString()}\r\n                              </time>\r\n                            </div>\r\n                            <p className=\"whitespace-pre-wrap break-words text-sm text-gray-800\">{c.content}</p>\r\n                          </div>\r\n                          {userId === c.user_id && (\r\n                            <button\r\n                              type=\"button\"\r\n                              onClick={async (e) => {\r\n                                e.preventDefault();\r\n                                e.stopPropagation();\r\n                                await deleteComment(c.id, selectedPost.id);\r\n                              }}\r\n                              disabled={deletingComment === c.id}\r\n                              className=\"opacity-0 group-hover:opacity-100 transition-opacity text-red-500 hover:text-red-700 p-1 rounded-full hover:bg-red-50 flex-shrink-0 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                              title=\"Delete comment\"\r\n                            >\r\n                              {deletingComment === c.id ? (\r\n                                <svg className=\"animate-spin\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                                  <path d=\"M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83\"/>\r\n                                </svg>\r\n                              ) : (\r\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                                  <path d=\"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2M10 11v6M14 11v6\"/>\r\n                                </svg>\r\n                              )}\r\n                            </button>\r\n                          )}\r\n                        </div>\r\n                      ))\r\n                    )}\r\n                  </div>\r\n\r\n                  {/* Comment Input - Fixed at bottom */}\r\n                  <div className=\"p-4 border-t border-gray-200 bg-white\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <input\r\n                        type=\"text\"\r\n                        placeholder={userId ? \"Add a commentâ€¦\" : \"Sign in to comment\"}\r\n                        value={newCommentContent[selectedPost.id] || \"\"}\r\n                        onChange={(e) => setNewCommentContent((p) => ({ ...p, [selectedPost.id]: e.target.value }))}\r\n                        className=\"flex-1 h-10 px-3 rounded-md border border-gray-300 focus:ring-2 focus:ring-[#8c52ff] focus:border-transparent outline-none text-sm\"\r\n                        disabled={!userId}\r\n                        onKeyDown={(e) => {\r\n                          if (e.key === \"Enter\" && !e.shiftKey && userId && (newCommentContent[selectedPost.id] || \"\").trim()) {\r\n                            e.preventDefault();\r\n                            submitComment(selectedPost.id);\r\n                          }\r\n                        }}\r\n                      />\r\n                      <button \r\n                        type=\"button\"\r\n                        onClick={(e) => {\r\n                          e.preventDefault();\r\n                          e.stopPropagation();\r\n                          submitComment(selectedPost.id);\r\n                        }} \r\n                        disabled={!userId || !(newCommentContent[selectedPost.id] || \"\").trim()} \r\n                        className=\"px-4 h-10 rounded-md bg-[#8c52ff] text-white disabled:opacity-50 disabled:cursor-not-allowed hover:opacity-90 text-sm font-medium\"\r\n                      >\r\n                        Post\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </Modal>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n"],"names":[],"mappings":"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","debugId":null}}]
}